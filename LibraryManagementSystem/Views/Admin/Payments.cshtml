@model List<LibraryManagementSystem.Models.Payment>

@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewData["Title"] = "Payments (Read-only)";
}

<h2 class="mb-3">Payments (Read-only Audit)</h2>

<div class="card">
    <div class="card-body">
        @if (Model == null || !Model.Any())
        {
            <div class="text-muted">No payments found.</div>
        }
        else
        {
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Student</th>
                            <th>Book</th>
                            <th>Amount</th>
                            <th>Method</th>
                            <th>Status</th>
                            <th>Txn Ref</th>
                            <th>Created</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            var sl = 1;
                        }
                        @foreach (var p in Model)
                        {
                            var bookTitle = p.Fine?.IssueRecord?.Book?.Title ?? "-";
                            <tr>
                                <td>@sl</td>
                                <td>@(p.Fine?.StudentEmail ?? "-")</td>
                                <td>@bookTitle</td>
                                <td><b>@p.Amount.ToString("0.00")</b></td>
                                <td>@p.Method</td>
                                <td>@p.Status</td>
                                <td>@(p.TransactionRef ?? "-")</td>
                                <td>@p.CreatedAt.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</td>
                            </tr>
                            sl++;
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>
</div>
