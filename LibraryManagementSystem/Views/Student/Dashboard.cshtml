@model LibraryManagementSystem.Models.StudentDashboardViewModel

@{
    Layout = null;
}

<link rel="stylesheet" href="~/css/dashboard.css" />

<div class="layout">

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="brand">
            <span class="brand-logo">📚</span>
            <span class="brand-name">LMS</span>
        </div>

        <nav class="menu">
            <a href="/Student/Dashboard" class="menu-item active">Dashboard</a>
            <a href="/Student/MyIssues" class="menu-item">My Issued Books</a>
            <a href="/Student/ViewBooks" class="menu-item">View Books (read-only)</a>
            <a href="/Account/Logout" class="menu-item">Logout</a>
        </nav>
    </aside>

    <!-- MAIN AREA -->
    <div class="main">

        <!-- TOP BAR -->
        <header class="topbar">
            <h1 class="page-title">Student Dashboard</h1>

            <div class="topbar-right">
                <div class="search-box">
                    <input type="text" placeholder="Search books..." />
                </div>
                <div class="user-badge">
                    <div class="avatar">S</div>
                    <div class="user-info">
                        <span class="user-name">@Model.StudentName</span>
                        <span class="user-role">Student</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- CONTENT -->
        <main class="content">

            <!-- MEMBERSHIP CARD -->
            <section class="grid-two" style="margin-bottom: 1.5rem;">
                <div class="panel" style="max-width: 420px;">
                    <div class="panel-header">
                        <h2>Membership Card</h2>
                    </div>
                    <div class="table-wrapper" style="padding:1rem 1.5rem;">
                        <p><strong>Type:</strong> @Model.MembershipType</p>
                        <p>
                            <strong>Status:</strong>
                            @if (Model.IsMembershipActive)
                            {
                                <span class="badge success">Active</span>
                            }
                            else
                            {
                                <span class="badge danger">Inactive</span>
                            }
                        </p>

                        @if (!string.IsNullOrEmpty(Model.MembershipBarcode))
                        {
                            <p><strong>Barcode:</strong> @Model.MembershipBarcode</p>
                        }

                        @if (Model.MembershipExpiry.HasValue)
                        {
                            <p><strong>Valid till:</strong> @Model.MembershipExpiry.Value.ToShortDateString()</p>
                        }

                        @if (!Model.HasPremiumAccess)
                        {
                            <p style="margin-top:0.5rem;">
                                Premium collection access unavailable.
                                <br />Please contact librarian to upgrade membership.
                            </p>
                        }
                        else
                        {
                            <p style="margin-top:0.5rem;">
                                You have <strong>Premium</strong> access.
                                You can borrow books from premium collection.
                            </p>
                        }
                    </div>
                </div>

                <div class="cards">
                    <div class="card">
                        <p class="card-label">Books Issued</p>
                        <p class="card-value">@Model.CurrentIssuedCount</p>
                        <p class="card-sub">Currently borrowed by you</p>
                    </div>
                    <div class="card">
                        <p class="card-label">Overdue</p>
                        <p class="card-value danger">@Model.OverdueCount</p>
                        <p class="card-sub">Need to return soon</p>
                    </div>
                    <div class="card">
                        <p class="card-label">Total Books</p>
                        <p class="card-value">@Model.TotalBooksCount</p>
                        <p class="card-sub">Available in library</p>
                    </div>
                    <div class="card">
                        <p class="card-label">Unpaid Fine</p>
                        <p class="card-value">@Model.TotalUnpaidFine.ToString("0.00")</p>
                        <p class="card-sub">Click “Pay Fine” to clear</p>
                    </div>
                </div>
            </section>

            <!-- RECENT ISSUES + NOTIFICATIONS / PREMIUM PREVIEW -->
            <section class="grid-two">

                <!-- Recent issues -->
                <div class="panel">
                    <div class="panel-header">
                        <h2>My Recent Issued Books</h2>
                        <a href="/Student/MyIssues" class="link-small">View all</a>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Book</th>
                                    <th>Issue Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.RecentIssues.Any())
                                {
                                    @foreach (var issue in Model.RecentIssues)
                                    {
                                        <tr>
                                            <td>@issue.Book?.Title</td>
                                            <td>@issue.IssueDate.ToShortDateString()</td>
                                            <td>@issue.Status</td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="3" style="text-align:center;">No issued books yet.</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Premium books preview -->
                <div class="panel">
                    <div class="panel-header">
                        <h2>Premium Collection Preview</h2>
                        <a href="/Student/ViewBooks" class="link-small">View all books</a>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Author</th>
                                    <th>Access</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.PremiumBooksSample.Any())
                                {
                                    @foreach (var b in Model.PremiumBooksSample)
                                    {
                                        <tr>
                                            <td>@b.Title</td>
                                            <td>@b.Author</td>
                                            <td>
                                                @if (Model.HasPremiumAccess)
                                                {
                                                    <span class="badge success">Available</span>
                                                }
                                                else
                                                {
                                                    <span class="badge warning">Premium only</span>
                                                }
                                            </td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="3" style="text-align:center;">No premium books configured.</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>

            </section>

            <!-- QUICK ACTIONS -->
            <section class="panel quick-actions">
                <div class="panel-header">
                    <h2>Quick Actions</h2>
                </div>
                <div class="actions-grid">

                    <a href="/Student/ViewBooks" class="action-card">
                        <h3>Browse Books</h3>
                        <p>See all available books in the library.</p>
                    </a>

                    <a href="/Student/MyIssues" class="action-card">
                        <h3>My Issued Books</h3>
                        <p>View and track your borrowed books.</p>
                    </a>

                    <a href="/Student/PayFine" class="action-card">
                        <h3>Pay Fine</h3>
                        <p>Review and pay your pending fines.</p>
                    </a>

                    <a href="/Student/PremiumCollection" class="action-card">
                        <h3>Premium Collection</h3>
                        <p>Explore premium membership benefits.</p>
                    </a>

                </div>

                 
            </section>

        </main>

        <footer class="footer">
            © 2025 Library Management System
        </footer>
    </div>
</div>
